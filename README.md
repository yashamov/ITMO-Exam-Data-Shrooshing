# ITMO-Exam-Data-Shrooshing

## 1. Цель проекта
Разработать систему выявления мошеннических транзакций на основе исторических данных о покупках клиентов.

**В рамках проекта выполнено:**
- Разведочный анализ данных (EDA)
- Поиск утечек признаков и их удаление
- Построение базовой модели машинного обучения
- Формулировка продуктовых и технических гипотез

---

## 2. Датасет

**Объем:** ~7.5 млн транзакций  
**Целевая переменная:** 'is_fraud'

**Общий уровень мошенничества:** 20%

---

## 3. Основные наблюдения из EDA

### Основные выводы описаны в Notebook вместе с визуализацией.
### В ходе анализа были обнаружены переменные, для которых свойственна утечка признака. При определенном значении is_fraud был равен 1 для всех записей.
### Были построены визуализации в виде гистограмм и тепловой карты с использованием библиотек seaborn, matplotlib
### 

---

## 4. Подготовка данных

### 4.1 Удаление признаков с утечкой а также изначальных полей, которые далее были преобразованы в категориальные и числовые признаки.
### 4.2 Создание признаков дня недели, часа в сутках и тд из timestamp
### 4.3 Конвертация всех сумм в $USD
### 4.4 Проверка на наличие пропусков

### 4.5 Разделение данных на тренировочную и тестовую выборки с помощью train_test_split из sklearn со стратификацией.

### 4.6 Препроцессинг
Числовые признаки с помощью RobustScaler
Числовые категориальные признаки, полученные во время анализа данных без изменений
Категориальные признаки → OneHotEncoder(handle_unknown='ignore', drop='if_binary')


## 5. ML
### Предлагается использование модели машинного обучения для классификации фрод транзакций.
### Для Бейзлайна и примера использовалась модель RandomForestClassifier из sklearn.ensemble


## 6. Результаты
### Модель показала наилучшие результаты при пороговом значении 0.631 в классификации фрод-транзакций. 
Этот порог позволяет сбалансировать точность и полноту, снижая количество ложноположительных срабатываний при минимальной потере полноты. P=0.887 | R=0.916 | F1=0.901
### Даже базовая настройка RandomForest с учетом балансировки классов дает очень высокое качество. 
Для продакшена потребуется дополнительная калибровка порога, возможно использование других моделей или тщательная настройка гиперпараметров, но уже сейчас модель уверенно выявляет большинство мошеннических транзакций.


## 7. Продуктовые гипотезы
### Рекомендуется спользование ML модели для выявления и предотвращения мошеннических транзакций посредством включения в систему мониторинга транзакций.
### Рекомендуется усилить контроль над транзакциями:
в ночное время, в определенных странах и валютах платежа, за пределами страны клиента, при отклонении значений суммы покупки от медианных для клиента показателей за все время, за последний час, при увеличении кол-ва вендоров.

### Стоит обратить внимание на каналы и устройства со 100% долей мошенничества. 
Либо требуется проверить корректность данных, либо заблокировать данные каналы оплаты и устройства.
### Возможно стоит учитывать индивидуальный особенности клиента, его поведенческий портрет и историю сделок.Возможно калибровать модель под сегмент клиента. 


